package co.milindjagre;

import java.util.List;

import com.gargoylesoftware.htmlunit.WebClient;
import com.gargoylesoftware.htmlunit.html.HtmlAnchor;
import com.gargoylesoftware.htmlunit.html.HtmlElement;
import java.math.BigDecimal;
import java.net.URLEncoder;
import com.gargoylesoftware.htmlunit.html.HtmlPage;
import com.fasterxml.jackson.databind.ObjectMapper;
import co.milindjagre.Item;

public class Test {

	/**
	 * @param args
	 */
	public static void main(String[] args) {
		String searchQuery = "password";
		String baseUrl = "https://www.at.ford.com/en/homepage.html";
		WebClient client = new WebClient();
		client.getOptions().setCssEnabled(false);
		client.getOptions().setJavaScriptEnabled(false);
		try {
			String searchUrl = baseUrl + "search/sss?sort=rel&query="
					+ URLEncoder.encode(searchQuery, "UTF-8");
			HtmlPage page = client.getPage(searchUrl);

			@SuppressWarnings("unchecked")
			List<HtmlElement> items = (List<HtmlElement>) page
					.getByXPath("//li[@class='result-row']");
			if (items.isEmpty()) {
				System.out.println("No items found !");
			} else {
				for (HtmlElement htmlItem : items) {
					HtmlAnchor itemAnchor = ((HtmlAnchor) htmlItem
							.getFirstByXPath(".//p[@class='result-info']/a"));
					HtmlElement spanPrice = ((HtmlElement) htmlItem
							.getFirstByXPath(".//a/span[@class='result-price']"));

					// It is possible that an item doesn't have any price, we
					// set the price to 0.0 in this case
					String itemPrice = spanPrice == null ? "0.0" : spanPrice
							.asText();

					Item item = new Item();
					item.setTitle(itemAnchor.asText());
					item.setUrl(baseUrl + itemAnchor.getHrefAttribute());

					item.setPrice(new BigDecimal(itemPrice.replace("$", "")));

					ObjectMapper mapper = new ObjectMapper();
					String jsonString = mapper.writeValueAsString(item);

					System.out.println(jsonString);
				}
			}
		} catch (Exception e) {
			e.printStackTrace();
		}
		client.close();
	}
}

package co.milindjagre;

import java.math.BigDecimal;

public class Item {
	private String title;
	private BigDecimal price;
	private String url;

	public String getTitle() {
		return title;
	}

	public void setTitle(String title) {
		this.title = title;
	}

	public BigDecimal getPrice() {
		return price;
	}

	public void setPrice(BigDecimal price) {
		this.price = price;
	}

	public String getUrl() {
		return url;
	}

	public void setUrl(String url) {
		this.url = url;
	}

}
